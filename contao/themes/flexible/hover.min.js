window.Theme={isWebkit:Browser.chrome||Browser.safari||navigator.userAgent.match(/(?:webkit|khtml)/i),stopClickPropagation:function(){$$(".picker_selector").each((function(e){e.getElements("a").each((function(e){e.addEvent("click",(function(e){e.stopPropagation()}))}))})),$$(".picker_selector,.click2edit").each((function(e){e.getElements('input[type="checkbox"]').each((function(e){e.addEvent("click",(function(e){e.stopPropagation()}))}))}))},setupCtrlClick:function(){$$(".click2edit").each((function(e){e.getElements("a").each((function(e){e.addEvent("click",(function(e){e.stopPropagation()}))})),Browser.Features.Touch?e.addEvent("click",(function(){e.getAttribute("data-visited")?(e.getElements("a").each((function(e){e.hasClass("edit")&&(document.location.href=e.href)})),e.removeAttribute("data-visited")):e.setAttribute("data-visited","1")})):e.addEvent("click",(function(t){(Browser.Platform.mac?t.event.metaKey:t.event.ctrlKey)&&(t.event.shiftKey?e.getElements("a").each((function(e){e.hasClass("children")&&(document.location.href=e.href)})):e.getElements("a").each((function(e){e.hasClass("edit")&&(document.location.href=e.href)})))}))}))},setupTextareaResizing:function(){$$(".tl_textarea").each((function(e){if(!(Browser.ie6||Browser.ie7||Browser.ie8||e.hasClass("noresize")||e.retrieve("autogrow"))){var t=new Element("div",{html:"X",styles:{position:"absolute",top:0,left:"-999em","overflow-x":"hidden"}}).setStyles(e.getStyles("font-size","font-family","width","line-height")).inject(document.body);"border-box"!=e.getStyle("-moz-box-sizing")&&"border-box"!=e.getStyle("-webkit-box-sizing")&&"border-box"!=e.getStyle("box-sizing")||t.setStyles({padding:e.getStyle("padding"),border:e.getStyle("border-left")});var n=Math.max(t.clientHeight,30);e.addEvent("input",(function(){t.set("html",this.get("value").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n|\r\n/g,"<br>X"));var e=Math.max(n,t.getSize().y);this.clientHeight!=e&&this.tween("height",e)})).set("tween",{duration:100}).setStyle("height",n+"px"),e.fireEvent("input"),e.store("autogrow",!0)}}))},setupMenuToggle:function(){var e=$("burger");if(e&&(e.addEvent("click",(function(){document.body.toggleClass("show-navigation"),e.setAttribute("aria-expanded",document.body.hasClass("show-navigation")?"true":"false")})).addEvent("keydown",(function(e){27==e.event.keyCode&&document.body.removeClass("show-navigation")})),window.matchMedia)){var t=window.matchMedia("(max-width:991px)"),n=function(){t.matches?(e.setAttribute("aria-controls","left"),e.setAttribute("aria-expanded",document.body.hasClass("show-navigation")?"true":"false")):(e.removeAttribute("aria-controls"),e.removeAttribute("aria-expanded"))};t.addEventListener("change",n),n()}},setupProfileToggle:function(){var e=$("tmenu");if(e){var t=e.getElement(".submenu"),n=t.getFirst("span").getFirst("button"),i=t.getFirst("ul");t&&n&&i&&(n.setAttribute("aria-controls","tmenu__profile"),n.setAttribute("aria-expanded","false"),i.id="tmenu__profile",n.addEvent("click",(function(e){t.hasClass("active")?(t.removeClass("active"),n.setAttribute("aria-expanded","false")):(t.addClass("active"),n.setAttribute("aria-expanded","true")),e.stopPropagation()})),$(document.body).addEvent("click",(function(){t.hasClass("active")&&t.removeClass("active")})))}},hideMenuOnScroll:function(){var e=$("header");if(e){var t=window.getSize().y,n=window.getScrollSize().y-t,i=0;!("ontouchmove"in window)||t>=n?e.removeClass("down"):window.addEvent("touchmove",(function(){var t=window.getScroll().y;Math.abs(i-t)<20||(t>0&&t>i?e.addClass("down"):e.removeClass("down"),i=t)})).addEvent("scroll",(function(){window.getScroll().y<1&&e.removeClass("down")}))}},setupSplitButtonToggle:function(){var e=$("sbtog");if(e){var t,n,i=e.getParent(".split-button").getElement("ul");e.addEvent("click",(function(n){t=!1,i.toggleClass("invisible"),e.toggleClass("active"),n.stopPropagation()})),$(document.body).addEvent("click",(function(){t=!1,i.addClass("invisible"),e.removeClass("active")})),$(document.body).addEvent("keydown",(function(e){t=9==e.event.keyCode})),[e].append(i.getElements("button")).each((function(o){o.addEvent("focus",(function(){t&&(i.removeClass("invisible"),e.addClass("active"),clearTimeout(n))})),o.addEvent("blur",(function(){t&&(n=setTimeout((function(){i.addClass("invisible"),e.removeClass("active")}),100))}))})),e.set("tabindex","-1")}}},window.addEvent("domready",(function(){Theme.stopClickPropagation(),Theme.setupCtrlClick(),Theme.setupTextareaResizing(),Theme.setupMenuToggle(),Theme.setupProfileToggle(),Theme.hideMenuOnScroll(),Theme.setupSplitButtonToggle()})),window.addEvent("ajax_change",(function(){Theme.stopClickPropagation(),Theme.setupCtrlClick(),Theme.setupTextareaResizing()}));