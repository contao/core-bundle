{"version":3,"file":"ajax-form.8d9f14a4.js","mappings":"AAAAA,OAAOC,iBAAiB,oBAAoB,KACxCC,SAASC,iBAAiB,oBAAoBC,SAAQC,KA2BlD,SAASC,EAASC,GACdA,EAAKN,iBAAiB,UAAUO,IAC5BA,EAAEC,iBAEF,MAAMC,EAAW,IAAIC,SAASJ,GAG1BC,EAAEI,WACFF,EAASG,OAAOL,EAAEI,UAAUE,KAAMN,EAAEI,UAAUG,OAlC1D,SAAiBR,EAAMS,EAAMC,GACzB,MAAMC,EAAM,IAAIC,eAEhBD,EAAIE,KAAK,OAAQb,EAAKc,QAAQ,GAC9BH,EAAII,iBAAiB,SAAU,aAC/BJ,EAAII,iBAAiB,mBAAoB,kBACzCJ,EAAII,iBAAiB,qBAAsBf,EAAKgB,cAAc,wBAAwBR,OAEtFR,EAAKiB,SAAW,OAChBjB,EAAKkB,QAAQC,SAAW,UAExBR,EAAIS,OAAS,KACTpB,EAAKqB,cAAc,IAAIC,YAAY,mBAAoB,CACnDC,SAAS,EACTC,OAAQ,CAAEf,OAAMT,OAAMW,UAG1BX,EAAKiB,SAAW,QAChBjB,EAAKkB,QAAQC,SAAW,GAExBT,EAASC,EAAI,EAGjBA,EAAIc,KAAKhB,GAAQ,KACrB,CAaQiB,CAAQ1B,EAAMG,GAAUQ,IACpB,MAAMgB,EAAWhB,EAAIiB,kBAAkB,mBAGvC,GAAID,EAEA,YADAlC,OAAOkC,SAASE,KAAOF,GAI3B,MAAMG,EAAWnC,SAASoC,cAAc,YACxCD,EAASE,UAAYrB,EAAIsB,aAAaC,OAEtC,MAAMC,EAAUL,EAASM,QAAQC,kBACjCrC,EAAKsC,YAAYH,GACjBpC,EAASoC,EAAQ,GACnB,GAEV,CAEApC,CAASD,EAAG,GACd","sources":["webpack:///./core-bundle/assets/ajax-form.js"],"sourcesContent":["window.addEventListener('DOMContentLoaded', () => {\n    document.querySelectorAll('[data-ajax-form]').forEach(el => {\n        function request(form, body, callback) {\n            const xhr = new XMLHttpRequest();\n\n            xhr.open('POST', form.action, true);\n            xhr.setRequestHeader('Accept', 'text/html');\n            xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n            xhr.setRequestHeader('X-Contao-Ajax-Form', form.querySelector('[name=\"FORM_SUBMIT\"]').value);\n\n            form.ariaBusy = 'true';\n            form.dataset.ajaxForm = 'loading';\n\n            xhr.onload = () => {\n                form.dispatchEvent(new CustomEvent('ajax-form-onload', {\n                    bubbles: true,\n                    detail: { body, form, xhr },\n                }));\n\n                form.ariaBusy = 'false';\n                form.dataset.ajaxForm = '';\n\n                callback(xhr);\n            };\n\n            xhr.send(body || null)\n        }\n\n        function initForm(form) {\n            form.addEventListener('submit', e => {\n                e.preventDefault();\n\n                const formData = new FormData(form);\n\n                // Send the triggered button data as well\n                if (e.submitter) {\n                    formData.append(e.submitter.name, e.submitter.value);\n                }\n\n                request(form, formData, xhr => {\n                    const location = xhr.getResponseHeader('X-Ajax-Location');\n\n                    // Handle the redirect header\n                    if (location) {\n                        window.location.href = location;\n                        return;\n                    }\n\n                    const template = document.createElement('template');\n                    template.innerHTML = xhr.responseText.trim();\n\n                    const newForm = template.content.firstElementChild;\n                    form.replaceWith(newForm);\n                    initForm(newForm);\n                });\n            });\n        }\n\n        initForm(el);\n    });\n});\n"],"names":["window","addEventListener","document","querySelectorAll","forEach","el","initForm","form","e","preventDefault","formData","FormData","submitter","append","name","value","body","callback","xhr","XMLHttpRequest","open","action","setRequestHeader","querySelector","ariaBusy","dataset","ajaxForm","onload","dispatchEvent","CustomEvent","bubbles","detail","send","request","location","getResponseHeader","href","template","createElement","innerHTML","responseText","trim","newForm","content","firstElementChild","replaceWith"],"sourceRoot":""}